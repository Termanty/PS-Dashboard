"use strict";(self.webpackChunkps_dashboard=self.webpackChunkps_dashboard||[]).push([[489],{6489:function(e,t,r){r.r(t),r.d(t,{default:function(){return Q}});var n=r(4942),a=r(885),o=r(1413),i=r(2791),s=r(7630),c=r(703),l=r(4554),d=r(1889),u=r(890),f=r(6030),m=r(8091),p=r(9836),h=r(3382),g=r(8745),x=r(618),y=r(9281),b=r(6890),v=r(5855),Z=r(9341),j=(r(6032),r(2426)),P=r.n(j),k=r(184),C=(0,s.ZP)(g.Z)((function(e){var t,r=e.theme;return t={},(0,n.Z)(t,"&.".concat(x.Z.head),{backgroundColor:r.palette.text.disabled,color:r.palette.common.white,fontSize:30}),(0,n.Z)(t,"&.".concat(x.Z.body),{fontSize:15,border:"solid 1px #ED6930",borderRight:0,fontFamily:"sans-serif"}),t})),S=(0,s.ZP)(v.Z)((function(e){var t=e.theme;return{"&:nth-of-type(odd)":{backgroundColor:t.palette.action.hover,border:1,borderColor:t.palette.common.primary},"&:nth-of-type(even)":{backgroundColor:t.palette.common.gray,color:t.palette.common.white},"&:last-child td, &:last-child th":{borderRight:0}}}));function D(e,t,r){return t[r]<e[r]?-1:t[r]>e[r]?1:0}function w(e,t){return"asc"===e?function(e,r){return D(e,r,t)}:function(e,r){return-D(e,r,t)}}function T(e,t){var r=e.map((function(e,t){return[e,t]}));return r.sort((function(e,r){var n=t(e[0],r[0]);return 0!==n?n:e[1]-r[1]})),r.map((function(e){return e[0]}))}var A=[{id:"created_at",label:"Date Created",minWidth:170,align:"right"},{id:"score",label:"Score",minWidth:170,align:"right"},{id:"comment",label:"Comments",minWidth:170,align:"right"}],R=function(e){var t=e.selection,r=e.dateFrom,n=e.dateTo,o=(0,f.I0)(),s=(0,i.useState)(0),l=(0,a.Z)(s,2),d=l[0],u=l[1],x=(0,i.useState)(4),j=(0,a.Z)(x,2),D=j[0],R=j[1],F=(0,i.useState)("asc"),z=(0,a.Z)(F,1)[0],I=(0,i.useState)("created_at"),M=(0,a.Z)(I,1)[0];(0,i.useEffect)((function(){return o((0,m.j9)())}),[]);var _=(0,f.v9)((function(e){return e.responses})),E=P().utc(n).add(1,"day").format("");return""!==r&&""!==E&&(_=_.filter((function(e){return e.created_at>=r&&e.created_at<=E}))),"Promoters"===t&&(_=_.filter((function(e){return e.score>=9}))),"Passives"===t&&(_=_.filter((function(e){return e.score>=7&&e.score<=8}))),"Detractors"===t&&(_=_.filter((function(e){return e.score<=6}))),(0,k.jsxs)(c.Z,{sx:{width:"100%",border:"solid 2px #ED6930"},children:[(0,k.jsx)(y.Z,{sx:{maxHeight:350},children:(0,k.jsxs)(p.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,k.jsx)(b.Z,{order:z,orderby:M,children:(0,k.jsx)(v.Z,{children:A.map((function(e){return(0,k.jsx)(g.Z,{align:e.align,style:{top:0,minWidth:e.minWidth,fontSize:20},children:e.label},e.id)}))})}),(0,k.jsx)(h.Z,{children:T(_,w(z,M)).slice(d*D,d*D+D).map((function(e){return(0,k.jsxs)(S,{children:[(0,k.jsx)(C,{align:"center",children:new Date(e.created_at).toDateString()}),(0,k.jsx)(C,{align:"center",children:e.score}),(0,k.jsx)(C,{align:"left",children:e.comment})]},e.id)}))})]})}),(0,k.jsx)(Z.Z,{rowsPerPageOptions:[4,10,25,50,100],component:"div",count:_.length,rowsPerPage:D,page:d,onPageChange:function(e,t){u(t)},onRowsPerPageChange:function(e){R(+e.target.value),u(0)}})]})},F=r(145),z=r(2322),I=r(5390),M=r(1048),_=r(7684),E=r(5667),L=r(5344);r(8292).kL.register(F.Z);(0,s.ZP)(c.Z)((function(e){var t=e.theme;return(0,o.Z)((0,o.Z)({backgroundColor:"dark"===t.palette.mode?"#1A2027":"#fff"},t.typography.body2),{},{padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));var W=function(e){var t=e.dateFrom,r=e.dateTo,n=P()(t).format(""),o=P().utc(r).add(1,"day").format(""),s=(0,i.useState)("all"),c=(0,a.Z)(s,2),p=c[0],h=c[1],g=(0,f.I0)();(0,i.useEffect)((function(){return g((0,m.j9)())}),[]);var x=(0,f.v9)((function(e){return e.responses})),y=0,b=0,v=0;if(""===t||""===r)for(var Z=0;Z<x.length;Z++)x[Z].score>=9&&b++,x[Z].score>=7&&x[Z].score<=8&&++v,x[Z].score<=6&&y++;else for(var j=0;j<x.length;j++){var C=P()(x[j].created_at).format("");C>=n&&C<=o&&(x[j].score>=9&&b++,x[j].score>=7&&x[j].score<=8&&++v,x[j].score<=6&&y++)}var S=b++,D=y++,w=v++,T=S+D+w,A=Math.round((S-D)/T*100),F=Math.min(Math.max(parseInt(A),-100),100),W=[{name:"Detractors",value:D},{name:"Passives",value:w},{name:"Promoters",value:S}],N=[{name:"NPS",value:F}],B=["#E26060","#F3C934","#52A569"],O=Math.PI/180;return(0,k.jsx)(l.Z,{sx:{flexGrow:1},children:(0,k.jsxs)(d.ZP,{container:!0,spacing:-3,children:[(0,k.jsxs)(d.ZP,{item:!0,xs:3,md:5,children:[(0,k.jsxs)(u.Z,{variant:"h5",component:"div",sx:{marginLeft:10,marginBottom:-10},children:["Total Responses ",T]}),(0,k.jsx)(d.ZP,{sx:{marginTop:0,marginLeft:-10},children:(0,k.jsxs)(z.u,{width:600,height:500,children:[(0,k.jsxs)(I.b,{data:W,cx:"45%",cy:"60%",labelLine:!1,label:function(e){var t=e.cx,r=e.cy,n=e.midAngle,a=e.innerRadius,o=e.outerRadius,i=e.index,s=a+.5*(o-a),c=t+s*Math.cos(-n*O),l=r+s*Math.sin(-n*O);return(0,k.jsx)("text",{x:c,y:l,fontSize:"25",fill:"white",textAnchor:c>t?"start":"end",dominantBaseline:"central",children:W[i].value})},innerRadius:60,outerRadius:120,paddingAngle:1,dataKey:"value",children:[W.map((function(e,t){return(0,k.jsx)(M.b,{fill:B[t%B.length],onClick:function(){return h(W[t].name)}},"cell-".concat(t))})),N.map((function(e,t){return(0,k.jsx)(_._,{value:"NPS ".concat(F),position:"center",fontFamily:"sans-serif",fontWeight:400,fontSize:"30",fill:"#555555",onClick:function(){return h(N[t].name)}},"cell-".concat(t))}))]}),(0,k.jsx)(E.u,{}),(0,k.jsx)(L.D,{height:100,iconType:"circle",align:"center",fontFamily:"sans-serif"})]})})]}),(0,k.jsx)(d.ZP,{item:!0,xs:4,md:6,sx:{marginTop:10,marginLeft:-6},children:(0,k.jsx)(R,{dateFrom:t,dateTo:r,selection:p})})]})})},N=r(3845);r(6546);function B(e,t){return e[P()(t).format("")]||(e[P()(t).format("")]=0),e[P()(t).format("")]++,e}function O(e){return e.created_at.slice(0,-1).split("T")[0]}var G=function(e){var t=e.chartData,r=e.options;return(0,k.jsx)(N.$Q,{data:t,options:r})};var H=function(e){var t=e.dateFrom,r=e.dateTo,n=(0,f.I0)();(0,i.useEffect)((function(){return n((0,m.j9)())}),[]);var a=(0,f.v9)((function(e){return e.responses})),o=P().utc(r).add(1,"day").format("");""!==t&&""!==o&&(a=a.filter((function(e){return e.created_at>=t&&e.created_at<=o})));var s=a.map(O).reduce(B,{}),l=a.filter((function(e){return e.score<=6})).map(O).reduce(B,{}),d=a.filter((function(e){return e.score>=7&&e.score<=8})).map(O).reduce(B,{}),u=a.filter((function(e){return e.score>=9})).map(O).reduce(B,{}),p={};Object.keys(s).forEach((function(e){var t=u[e]||0,r=l[e]||0,n=s[e],a=Math.round((t-r)/n*100);p[e]=Math.min(Math.max(parseInt(a),-100),100)}));var h={labels:"",datasets:[{label:"NPS",data:p,showLine:!0,type:"line",order:0,borderColor:" #ED6930",tension:.2,hoverPointRadius:1,backgroundColor:["#ED6930"],yAxisID:"NPS"},{label:"Detractors",data:l,backgroundColor:["#E26060"],categoryPercentage:1,barPercentage:.8,yAxisID:"y",type:"bar"},{label:"Passives",data:d,backgroundColor:["#F3C934"],categoryPercentage:1,barPercentage:.8,yAxisID:"y",type:"bar"},{label:"Promoters",data:u,backgroundColor:["#52A569"],categoryPercentage:1,barPercentage:.8,yAxisID:"y",type:"bar"},{label:"Total Responses",data:s,backgroundColor:["#162667"],borderColor:" #ffffff",borderWidth:1,order:1,showLine:!1,pointRadius:4,tension:.7,yAxisID:"y",type:"line"}]};return(0,k.jsx)(c.Z,{elevation:0,sx:{borderColor:"#F6F7F9",boxShadow:2,width:"100%",borderRadius:5,margin:6,height:"80%"},children:(0,k.jsx)(G,{chartData:h,options:{maintainAspectRatio:!1,layout:{padding:30},plugins:{tooltip:{yAlign:"bottom"},legend:{position:"top",display:!0,labels:{font:{size:15},usePointStyle:!0,pointStyle:"circle"}},title:{display:!0,text:"Response volume",align:"center",padding:{bottom:10},font:{size:15}}},scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"MMM d, yy"}},stacked:!0,offset:!0,ticks:{maxRotation:30,minRotation:30,font:{size:15}}},y:{title:{display:!0,text:"Responses/day",font:{size:15}},stacked:!0,beginAtZero:!0,type:"linear",position:"left",ticks:{font:{size:15}}},NPS:{title:{display:!0,text:"NPS Score/day ",font:{size:15}},stacked:!0,beginAtZero:!0,type:"linear",position:"right",grid:{drawOnChartArea:!1},ticks:{font:{size:15}}}},responsive:!0},dateTo:r,dateFrom:t})})},K=r(9218);(0,s.ZP)(c.Z)((function(e){var t=e.theme;return(0,o.Z)((0,o.Z)({backgroundColor:"dark"===t.palette.mode?"#1A2027":"#fff"},t.typography.body2),{},{padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));var Q=function(e){e.selection;var t=(0,i.useState)(P()(new Date).format("2021-12-01")),r=(0,a.Z)(t,2),o=r[0],s=r[1],c=(0,i.useState)(P()(new Date).format("2022-05-31")),u=(0,a.Z)(c,2),f=u[0],m=u[1];return(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(l.Z,{elevation:0,sx:{marginLeft:5},maxWidth:"90%",children:[(0,k.jsx)(l.Z,{sx:{marginTop:0},children:(0,k.jsx)(d.ZP,{container:!0,alignItems:"flex-end",direction:"column",sx:{marginBottom:-10,marginLeft:-20},children:(0,k.jsxs)(d.ZP,{sx:{margin:0,display:"inline-flex",columnGap:1},children:[(0,k.jsx)(K.Z,{inputProps:{style:{fontSize:20}},helperText:"select start Date",color:"success",sx:(0,n.Z)({m:1,width:"180px"},"& fieldset",{borderRadius:"30px",backgroundColor:"rgba(184, 179, 179, 0.781)",height:"40px",marginTop:"14px"}),type:"date",id:"dateFrom",value:o,onChange:function(e){return s(e.target.value)}}),(0,k.jsx)(K.Z,{inputProps:{style:{fontSize:20}},sx:(0,n.Z)({m:1,width:"180px"},"& fieldset",{borderRadius:"30px",borderColor:"rgba(184, 179, 179, 0.781)",backgroundColor:"rgba(184, 179, 179, 0.781)",height:"40px",marginTop:"14px"}),color:"success",helperText:"select end Date",type:"date",id:"dateTo",value:f,onChange:function(e){return m(e.target.value)}})]})})}),(0,k.jsx)(W,{dateFrom:o,dateTo:f}),(0,k.jsx)(d.ZP,{container:!0,spacing:-3,children:(0,k.jsx)(d.ZP,{item:!0,xs:3,md:10,sx:{marginTop:-1,marginLeft:-10},children:(0,k.jsx)(H,{dateFrom:o,dateTo:f})})})]})})}}}]);
//# sourceMappingURL=489.4ad85af6.chunk.js.map